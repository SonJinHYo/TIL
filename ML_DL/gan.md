# GAN (Generative Adeversarial Network)



#### 개요

- 생성자와 판별자를 경쟁적으로 학습시켜 새로운 데이터를 생성하는 비지도학습 기반 생성모형
- 이미지 생성, 이미지 인페이팅, 추상화 추론, 의미론적 분할, 비디오 생성, 텍스트로부터 이미지 생성 등에 활용



참가자 2명의 제로섬 게임에 기초를 둔다.

- 생성자(G), 판별자 (D)로 구성
- 생성자는 진짜 데이터와 생성자에 의해 만들어지는 가짜데이터를 구별할 수 없도록 판별자를 속이려 한다.
- 판별자는 진짜 데이터를 가짜 데이와 구별하기 위해 학습한다.
- 최적의 해결책은 **내시 균형**에 의해 주어진다
  - 내시 균형 : 참가자들이 최선의 선택을 하면 서로가 자신의 선택을 바꾸지 않는 균형 상태



### GAN 의 이익함수

- 최대극소화 전략 : 2인 영합게임에서, 한 참가자가 입을 수 있는 최대 손실을 최소화하는 전략

- 만약 참가자의 이익과 손실의 합이 0이 되는 영합 게임이라면, 최대극소화 전략 == 최소극대화 전략

- 이익함수(or 손실함수)

  - 판별자가 진짜 데이터와 가짜 데이터를 정확하게 분류하도록 학습시켜야 함
  - 동시에 log(1-D(G(x)))를 최소화하도록 생성자를 학습

  - 최종 이익함수

    <img src="https://raw.githubusercontent.com/SonJinHYo/image_repo/main/image_server/image-20221110151018571.png" alt="image-20221110151018571" style="zoom:80%;" />

    - x: 확률분포 P<sub>x</sub>(x)로부터 관측된 진짜 데이터  //  z : 사전분포 P<sub>z</sub>(z)로부터 생성된 잡음

### 학습

- 판별자가 진짜 데이터 x에 대해 1을 출력하고, 잡음표본 z를 기반으로 생성자가 만든 가짜에 대해서는 0 출력
  - D(x)를 가능한 1에 가깝도록 => D(x) 최대화
  - D(G(z))는 0에 가깝도록 => log(1-D(G(z))) 최대화
  - 판별자는 x와 y의 전체 분포에 대해 이를 수행하므로 기댓값을 사용
- 생성자는 판별자의 이익함수 U(D,G)의 두번째 항에 **G(z)** 형태로 나타남
  - 생성자는 판별자의 이익을 최소화하는 전략을 선택 => 생성자의 이익함수 V(D,G) = -U(D,G)
    - 생성자는 U(D,G)를 최소화하는 전략 선택



#### 알고리즘

<img src="https://raw.githubusercontent.com/SonJinHYo/image_repo/main/image_server/image-20221110152112396.png" alt="image-20221110152112396" style="zoom:80%;" />

- k : 하이퍼 파라미터



##### 기본 GAN의 문제점

- 비수렴성 : 내시 군형 문제에서는 우수한 성능 But, 경사하강법은 볼록 문제에서만 내시군형 유지
  - 즉, 완벽한 균형을 확보하기 어려워서 **매개변수가 진동, 불안정**
- 모드 붕괴 : 최소-최대 게임이므로 분명한 손실함수가 없다.
  - 즉, 생성자가 개선되는지 판단하기 어려움 => 같은 데이터를 생성하여 극솟값에 빠지도록 만들어지는 문제
- 기울기 소멸 문제 : 판별자가 너무 대단해서 생성자의 기울기가 사라져버리면서 학습이 안되는 문제
- 하이퍼 파라미터에 매우 민감







## 기본 경쟁적 생성망의 분석

**정보량(divergence)** : 2개의 분포 P, Q의 차이를 나타내는 대표적인 측도



GAN 관련 divergence

![image-20221110152713981](https://raw.githubusercontent.com/SonJinHYo/image_repo/main/image_server/image-20221110152713981.png)



### LSGAN (최소제곱 경쟁적 생성망)

- 기본 GAN 판별자는 sigmoid, CrossEntropy 사용
  - 기울기 소멸 문제 발생
    - LSGAN 등장
- LSGAN
